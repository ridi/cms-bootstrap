global
    ulimit-n        131072
    log 127.0.0.1   local0
    log 127.0.0.1   local1 notice
    maxconn 60000
    tune.ssl.default-dh-param 2048

defaults
    log     global
    mode    http
    option  httplog
    option  dontlognull
    timeout connect 5000
    timeout client  50000
    timeout server  50000
    balance roundrobin

listen stats
    bind *:8080
    stats enable
    stats uri /stats
    stats realm Haproxy\ Statistics
    option redispatch

frontend http
    bind *:80

    acl is_admin path_beg /super/
    use_backend admin if is_admin

    acl is_example path_beg /example/
    use_backend example if is_example

    default_backend cms

frontend https
    bind *:443 ssl crt /usr/local/etc/haproxy/ssl.pem
    reqadd X-Forwarded-Proto:\ https

    acl is_admin path_beg /super/
    use_backend admin if is_admin

    acl is_example path_beg /example/
    use_backend example if is_example

	default_backend cms

backend cms
    option forwardfor
    server cms cms_main:80

backend admin
    option forwardfor
    server admin cms_admin:80

backend example
    option forwardfor
    server example cms_example:80
